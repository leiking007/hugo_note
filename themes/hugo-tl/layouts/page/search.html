{{ define "head" }}
    {{- with .OutputFormats.Get "json" -}} 
        {{/*  preload：缓存该资源  */}}
        <link rel="preload" href="{{ .Permalink }}" as="fetch" crossorigin="anonymous">
    {{- end -}}
{{ end }}

{{ define "main" }}
<div>
    <div class="flex">
        <label for="searchInput" class="self-center mr-3">{{- T "search.title"  -}}</label>
        <input type="search" id="searchInput"
               class="block w-5/6 rounded-md border-0 py-2 px-4 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600"
        placeholder=" {{- T `search.placeholder` -}} " 
        autocomplete="off" {{ with .OutputFormats.Get "json" -}} data-json="{{ .Permalink }}"{{- end }}>
    </div>
    <div id="search-result" class="mt-3 break-words">
        <h3 id="search-result-title"></h3>
        <div id="search-result-list"></div>
    </div>
</div>

<script>
    window.searchResultTitleTemplate = "{{ T `search.resultTitle` }}"
</script>

{{- $opts := dict "minify" hugo.IsProduction -}}
{{- $searchScript := resources.Get "ts/search.ts" | js.Build $opts | resources.Fingerprint "sha256" -}}
{{/*  defer 页面加载完成后再执行  */}}
<script type="text/javascript" src="{{ $searchScript.RelPermalink }}" defer></script>
{{ end }}