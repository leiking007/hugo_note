{{ define "head" }}
    {{- with .OutputFormats.Get "json" -}} 
        {{/*  preload：缓存该资源  */}}
        <link rel="preload" href="{{ .Permalink }}" as="fetch" crossorigin="anonymous">
    {{- end -}}
{{ end }}

{{ define "main" }}
<div>
    <div class="form-floating mb-3">
        <input class="form-control" id="searchInput" 
        placeholder=" {{- T `search.placeholder` -}} " 
        autocomplete="off" {{ with .OutputFormats.Get "json" -}} data-json="{{ .Permalink }}"{{- end }}>
        {{/*  18n  */}}
        <label for="searchInput" style="left:0.5rem">{{- T "search.title"  -}}</label>
    </div>
    <div id="search-result">
        <h3 id="search-result-title"></h3>
        <div id="search-result-list"></div>
    </div>
</div>

<script>
    window.searchResultTitleTemplate = "{{ T `search.resultTitle` }}"
</script>

{{- $opts := dict "minify" hugo.IsProduction -}}
{{- $searchScript := resources.Get "ts/search.ts" | js.Build $opts | resources.Fingerprint "sha256" -}}
{{/*  defer 页面加载完成后再执行  */}}
<script type="text/javascript" src="{{ $searchScript.RelPermalink }}" defer></script>
{{ end }}